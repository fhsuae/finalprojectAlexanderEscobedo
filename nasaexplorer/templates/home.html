{% extends "base.html" %}

{% block content %}
  <h1>NASA Astronomy Picture of the Day</h1>

  {% if apod %}
    <!-- Display APOD title and date -->
    <h2>{{ apod.title }}</h2>
    <p><em>{{ apod.date }}</em></p>

    <!-- Show image or video based on media type -->
    {% if apod.media_type == "image" %}
      <img src="{{ apod.url }}" alt="{{ apod.title }}" style="max-width:100%; height:auto;">
    {% elif apod.media_type == "video" %}
      <iframe width="560" height="315" src="{{ apod.url }}" frameborder="0" allowfullscreen></iframe>
    {% endif %}

    {% if user.is_authenticated %}
      <!-- Add to favorites form for logged in users -->
      <form method="post" action="{% url 'space:add_favorite' %}" class="mt-3">
        {% csrf_token %}
        <input type="hidden" name="image_id" value="{{ apod.url }}" />
        <input type="hidden" name="image_title" value="{{ apod.title }}" />
        <input type="hidden" name="image_url" value="{{ apod.url }}" />
        <button type="submit" class="btn btn-outline-primary">
          Add to Favorites
        </button>
      </form>
    {% endif %}

    <!-- APOD explanation text -->
    <p>{{ apod.explanation }}</p>
  {% else %}
    <!-- Message shown if APOD data is unavailable -->
    <p>Sorry, NASA APOD data is not available at the moment.</p>
  {% endif %}
{% endblock %}
